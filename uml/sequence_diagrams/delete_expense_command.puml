@startuml  delete_expense_command

hide footbox
skinparam MinClassWidth 50
skinparam ParticipantPadding 10
skinparam Shadowing false
skinparam DefaultTextAlignment center
skinparam packageStyle Rectangle

skinparam Sequence {
    MessageAlign center
    BoxFontSize 15
    BoxPadding 0
    BoxFontColor #FFFFFF
    ReferenceBackgroundColor #FFFFFF
}

box Model #F97181
participant "dataModel: Model" as Model order 3
participant "expenseTracker: ExpenseTracker" as ExpenseTracker order 4
participant "expenses: ExpenseList" as ExpenseList order 5
end box

box Logic #C8C8FA
participant ":DeleteExpenseCommand" as Command  order 1
end box

[->Command: execute(dataModel)
activate Command
Command -> Model: getFilteredExpenseList()
activate Model
Model --> Command: lastShownList
deactivate Model

Command -> Model
ref over Model
    : get expense from 
    : lastShownList using parsed index 
end ref
Model --> Command

Command -> Model: deleteExpense(expense)
activate Model
Model -> ExpenseTracker: deleteExpense(expense)
activate ExpenseTracker
ExpenseTracker -> ExpenseList: remove(expense)
activate ExpenseList
ExpenseList -> ExpenseList: remove expense from \nObservableList<Expense>
ExpenseList --> ExpenseTracker
deactivate ExpenseList
ExpenseTracker -> ExpenseList: sortList()
activate ExpenseList
ExpenseList -> ExpenseList: sort expenses in \nObservableList<Expense>\nby date
ExpenseList --> ExpenseTracker
deactivate ExpenseList
ExpenseTracker --> Model
deactivate ExpenseTracker
Model -> Model: updateFilteredExpenseList\n(PREDICATE_SHOW_ALL_EXPENSES)
activate Model
deactivate Model
Model --> Command
deactivate Model
create ":CommandResult" as CommandResult order 1
Command -> CommandResult 
activate CommandResult
CommandResult --> Command
deactivate CommandResult
[<-- Command: result
destroy Command

@enduml
